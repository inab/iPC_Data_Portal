{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _emotion = require(\"emotion\");\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _reactDatepicker = _interopRequireDefault(require(\"react-datepicker\"));\n\nrequire(\"react-datepicker/dist/react-datepicker.css\");\n\nvar _utils = require(\"../SQONView/utils\");\n\nrequire(\"./AggregationCard.css\");\n\nvar _AggsWrapper = _interopRequireDefault(require(\"./AggsWrapper\"));\n\nrequire(\"./DatesAgg.css\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar SQON_DATE_FORMAT = 'YYYY-MM-DD';\n\nvar dateFromSqon = function dateFromSqon(dateString) {\n  return (0, _moment[\"default\"])(dateString, SQON_DATE_FORMAT);\n};\n\nvar momentToSqonDate = function momentToSqonDate(moment) {\n  return moment === null || moment === void 0 ? void 0 : moment.format(SQON_DATE_FORMAT);\n};\n\nvar DatesAgg =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DatesAgg, _React$Component);\n\n  function DatesAgg(props) {\n    var _this;\n\n    _classCallCheck(this, DatesAgg);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DatesAgg).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"initializeState\", function (_ref) {\n      var _ref$stats = _ref.stats,\n          stats = _ref$stats === void 0 ? {} : _ref$stats,\n          _ref$getActiveValue = _ref.getActiveValue,\n          getActiveValue = _ref$getActiveValue === void 0 ? function () {\n        return null;\n      } : _ref$getActiveValue;\n      var field = _this.props.field;\n      var minDate = stats.min && (0, _moment[\"default\"])(stats.min).subtract(1, 'days');\n      var maxDate = stats.max && (0, _moment[\"default\"])(stats.max).add(1, 'days');\n      var startFromSqon = getActiveValue({\n        op: '>=',\n        field: field\n      });\n      var endFromSqon = getActiveValue({\n        op: '<=',\n        field: field\n      });\n      return {\n        minDate: minDate,\n        maxDate: maxDate,\n        startDate: startFromSqon ? dateFromSqon(startFromSqon) : null,\n        endDate: endFromSqon ? dateFromSqon(endFromSqon) : null\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateSqon\", function () {\n      var _this$state = _this.state,\n          startDate = _this$state.startDate,\n          endDate = _this$state.endDate;\n      var _this$props = _this.props,\n          field = _this$props.field,\n          handleDateChange = _this$props.handleDateChange;\n\n      if (handleDateChange && field) {\n        var content = [].concat(_toConsumableArray(startDate ? [{\n          op: '>=',\n          content: {\n            field: field,\n            value: momentToSqonDate(startDate.startOf('day'))\n          }\n        }] : []), _toConsumableArray(endDate ? [{\n          op: '<=',\n          content: {\n            field: field,\n            value: momentToSqonDate(endDate.endOf('day'))\n          }\n        }] : []));\n        handleDateChange({\n          field: field,\n          value: content,\n          generateNextSQON: function generateNextSQON(sqon) {\n            return (0, _utils.replaceSQON)(content.length ? {\n              op: 'and',\n              content: content\n            } : null, (0, _utils.removeSQON)(field, sqon));\n          }\n        });\n      }\n    });\n\n    _this.state = _this.initializeState(props);\n    return _this;\n  }\n\n  _createClass(DatesAgg, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      this.setState(this.initializeState(nextProps));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          _this$props2$displayN = _this$props2.displayName,\n          displayName = _this$props2$displayN === void 0 ? 'Date Range' : _this$props2$displayN,\n          _this$props2$collapsi = _this$props2.collapsible,\n          collapsible = _this$props2$collapsi === void 0 ? true : _this$props2$collapsi,\n          WrapperComponent = _this$props2.WrapperComponent,\n          _this$props2$facetVie = _this$props2.facetView,\n          facetView = _this$props2$facetVie === void 0 ? false : _this$props2$facetVie;\n      var _this$state2 = this.state,\n          minDate = _this$state2.minDate,\n          maxDate = _this$state2.maxDate,\n          startDate = _this$state2.startDate,\n          endDate = _this$state2.endDate;\n      return _react[\"default\"].createElement(_AggsWrapper[\"default\"], {\n        displayName: displayName,\n        WrapperComponent: WrapperComponent,\n        collapsible: collapsible\n      }, _react[\"default\"].createElement(\"div\", {\n        className:\n        /*#__PURE__*/\n        (0, _emotion.css)(\"display:flex;align-items:center;justify-content:space-around;\")\n      }, _react[\"default\"].createElement(_reactDatepicker[\"default\"], _extends({\n        minDate: minDate,\n        maxDate: maxDate\n      }, {\n        isClearable: true,\n        openToDate: minDate,\n        popperPlacement: facetView ? 'bottom-start' : 'top-start',\n        disabledKeyboardNavigation: true,\n        placeholderText: \"Start Date\",\n        selected: startDate,\n        onChange: function onChange(x) {\n          return _this2.setState({\n            startDate: x\n          }, _this2.updateSqon);\n        },\n        \"aria-label\": \"Pick start date\"\n      })), _react[\"default\"].createElement(_reactDatepicker[\"default\"], _extends({\n        minDate: minDate,\n        maxDate: maxDate\n      }, {\n        isClearable: true,\n        openToDate: maxDate,\n        popperPlacement: facetView ? 'bottom-end' : 'top-start',\n        disabledKeyboardNavigation: true,\n        placeholderText: \"End Date\",\n        selected: endDate,\n        onChange: function onChange(x) {\n          return _this2.setState({\n            endDate: x\n          }, _this2.updateSqon);\n        },\n        \"aria-label\": \"Pick end date\"\n      }))));\n    }\n  }]);\n\n  return DatesAgg;\n}(_react[\"default\"].Component);\n\nvar _default = DatesAgg;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}