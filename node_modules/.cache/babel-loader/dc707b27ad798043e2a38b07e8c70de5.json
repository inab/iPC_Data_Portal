{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = require(\"lodash\");\n\nvar _recompose = require(\"recompose\");\n\nvar _Query = require(\"../../Query\");\n\nvar _QuickSearchQuery = require(\"./QuickSearchQuery\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar nestedField = function nestedField(_ref) {\n  var field = _ref.field,\n      nestedFields = _ref.nestedFields;\n  return nestedFields.find(function (x) {\n    return x.field === field.field.split('.').slice(0, -1).join('.');\n  });\n};\n\nvar enhance = (0, _recompose.compose)((0, _Query.withQuery)(function (_ref2) {\n  var index = _ref2.index,\n      projectId = _ref2.projectId;\n  return {\n    projectId: projectId,\n    key: 'extendedFields',\n    query: \"\\n      query \".concat((0, _lodash.capitalize)(index), \"ExtendedQuery {\\n        \").concat(index, \" {\\n          extended\\n          columnsState {\\n            state {\\n              columns {\\n                field\\n                query\\n                jsonPath\\n              }\\n            }\\n          }\\n        }\\n      }\\n    \")\n  };\n}), (0, _recompose.withProps)(function (_ref3) {\n  var _data$index, _data$index$extended, _data$index2, _data$index2$extended, _data$index2$extended2, _data$index2$extended3, _data$index2$extended4, _data$index4, _data$index4$columnsS, _data$index5, _data$index5$extended, _data$index5$extended2;\n\n  var index = _ref3.index,\n      whitelist = _ref3.whitelist,\n      _ref3$extendedFields = _ref3.extendedFields,\n      data = _ref3$extendedFields.data,\n      loading = _ref3$extendedFields.loading,\n      error = _ref3$extendedFields.error,\n      _ref3$nestedFields = _ref3.nestedFields,\n      nestedFields = _ref3$nestedFields === void 0 ? data === null || data === void 0 ? void 0 : (_data$index = data[index]) === null || _data$index === void 0 ? void 0 : (_data$index$extended = _data$index.extended) === null || _data$index$extended === void 0 ? void 0 : _data$index$extended.filter(function (x) {\n    return x.type === 'nested';\n  }) : _ref3$nestedFields,\n      _ref3$quickSearchFiel = _ref3.quickSearchFields,\n      quickSearchFields = _ref3$quickSearchFiel === void 0 ? (data === null || data === void 0 ? void 0 : (_data$index2 = data[index]) === null || _data$index2 === void 0 ? void 0 : (_data$index2$extended = _data$index2.extended) === null || _data$index2$extended === void 0 ? void 0 : (_data$index2$extended2 = _data$index2$extended.filter(function (x) {\n    return x.quickSearchEnabled;\n  })) === null || _data$index2$extended2 === void 0 ? void 0 : (_data$index2$extended3 = _data$index2$extended2.filter(function (x) {\n    var _ref4 = //defaults to \"\" because a root field's parent would evaluate to such\n    nestedField({\n      nestedFields: nestedFields,\n      field: x\n    }) || {},\n        _ref4$field = _ref4.field,\n        parentField = _ref4$field === void 0 ? '' : _ref4$field;\n\n    return whitelist ? whitelist.includes(parentField) : true;\n  })) === null || _data$index2$extended3 === void 0 ? void 0 : (_data$index2$extended4 = _data$index2$extended3.map(function (_ref5) {\n    var _data$index3, _data$index3$columnsS;\n\n    var field = _ref5.field;\n    return (0, _QuickSearchQuery.decorateFieldWithColumnsState)({\n      columnsState: data === null || data === void 0 ? void 0 : (_data$index3 = data[index]) === null || _data$index3 === void 0 ? void 0 : (_data$index3$columnsS = _data$index3.columnsState) === null || _data$index3$columnsS === void 0 ? void 0 : _data$index3$columnsS.state,\n      field: field\n    });\n  })) === null || _data$index2$extended4 === void 0 ? void 0 : _data$index2$extended4.map(function (x) {\n    var _nestedField;\n\n    return _objectSpread({}, x, {\n      entityName: ((_nestedField = nestedField({\n        field: x,\n        nestedFields: nestedFields\n      })) === null || _nestedField === void 0 ? void 0 : _nestedField.displayName) || index\n    });\n  })) || [] : _ref3$quickSearchFiel;\n  return {\n    quickSearchFields: quickSearchFields,\n    quickSearchEntities: (0, _lodash.uniq)(quickSearchFields.map(function (x) {\n      return x.entityName;\n    })),\n    primaryKeyField: (0, _QuickSearchQuery.decorateFieldWithColumnsState)({\n      columnsState: data === null || data === void 0 ? void 0 : (_data$index4 = data[index]) === null || _data$index4 === void 0 ? void 0 : (_data$index4$columnsS = _data$index4.columnsState) === null || _data$index4$columnsS === void 0 ? void 0 : _data$index4$columnsS.state,\n      field: data === null || data === void 0 ? void 0 : (_data$index5 = data[index]) === null || _data$index5 === void 0 ? void 0 : (_data$index5$extended = _data$index5.extended) === null || _data$index5$extended === void 0 ? void 0 : (_data$index5$extended2 = _data$index5$extended.find(function (x) {\n        return x.primaryKey;\n      })) === null || _data$index5$extended2 === void 0 ? void 0 : _data$index5$extended2.field\n    }),\n    nestedFields: nestedFields\n  };\n}));\n\nvar QuickSearchFieldsQuery = function QuickSearchFieldsQuery(_ref6) {\n  var render = _ref6.render,\n      quickSearchFields = _ref6.quickSearchFields,\n      quickSearchEntities = _ref6.quickSearchEntities,\n      primaryKeyField = _ref6.primaryKeyField;\n  return render({\n    quickSearchFields: quickSearchFields,\n    quickSearchEntities: quickSearchEntities,\n    primaryKeyField: primaryKeyField,\n    enabled: primaryKeyField && (quickSearchFields === null || quickSearchFields === void 0 ? void 0 : quickSearchFields.length)\n  });\n};\n\nvar _default = enhance(QuickSearchFieldsQuery);\n\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}