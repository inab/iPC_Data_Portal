{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/acanosa/React_arranger_template/node_modules/@babel/runtime/regenerator\");\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactComponentComponent = _interopRequireDefault(require(\"react-component-component\"));\n\nvar _api = _interopRequireWildcard(require(\"./api\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nvar memoHash = {};\n\nvar memoizedExtendedMapping = function memoizedExtendedMapping(_ref) {\n  var projectId = _ref.projectId,\n      graphqlField = _ref.graphqlField,\n      api = _ref.api;\n  var key = \"\".concat(projectId, \"/\").concat(graphqlField);\n\n  if (!memoHash[key]) {\n    memoHash[key] = (0, _api.fetchExtendedMapping)({\n      projectId: projectId,\n      graphqlField: graphqlField,\n      api: api\n    });\n  }\n\n  return memoHash[key];\n};\n\nvar memoizedExtendedMappingField = function memoizedExtendedMappingField(_ref2) {\n  var contentField = _ref2.contentField,\n      projectId = _ref2.projectId,\n      graphqlField = _ref2.graphqlField,\n      api = _ref2.api;\n  var key = \"\".concat(projectId, \"/\").concat(graphqlField, \"/\").concat(contentField);\n\n  if (!memoHash[key]) {\n    memoHash[key] = memoizedExtendedMapping({\n      projectId: projectId,\n      graphqlField: graphqlField,\n      api: api\n    }).then(function (_ref3) {\n      var extendedMapping = _ref3.extendedMapping;\n      return extendedMapping.filter(function (_ref4) {\n        var field = _ref4.field;\n        return field === contentField;\n      });\n    });\n  }\n\n  return memoHash[key];\n};\n\nvar ExtendedMappingProvider = function ExtendedMappingProvider(_ref5) {\n  var projectId = _ref5.projectId,\n      graphqlField = _ref5.graphqlField,\n      _ref5$api = _ref5.api,\n      api = _ref5$api === void 0 ? _api.default : _ref5$api,\n      _ref5$useCache = _ref5.useCache,\n      useCache = _ref5$useCache === void 0 ? true : _ref5$useCache,\n      contentField = _ref5.field,\n      children = _ref5.children;\n  var initialState = {\n    loading: true,\n    extendedMapping: undefined\n  };\n\n  var didMount =\n  /*#__PURE__*/\n  function () {\n    var _ref6 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(s) {\n      var extendedMapping, _ref9, _extendedMapping;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!contentField) {\n                _context.next = 14;\n                break;\n              }\n\n              if (useCache) {\n                _context.next = 7;\n                break;\n              }\n\n              _context.next = 4;\n              return (0, _api.fetchExtendedMapping)({\n                projectId: projectId,\n                graphqlField: graphqlField,\n                api: api\n              }).then(function (_ref7) {\n                var extendedMapping = _ref7.extendedMapping;\n                return extendedMapping.filter(function (_ref8) {\n                  var field = _ref8.field;\n                  return field === contentField;\n                });\n              });\n\n            case 4:\n              _context.t0 = _context.sent;\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.next = 9;\n              return memoizedExtendedMappingField({\n                projectId: projectId,\n                graphqlField: graphqlField,\n                api: api,\n                contentField: contentField\n              });\n\n            case 9:\n              _context.t0 = _context.sent;\n\n            case 10:\n              extendedMapping = _context.t0;\n              s.setState({\n                loading: false,\n                extendedMapping: extendedMapping\n              });\n              _context.next = 26;\n              break;\n\n            case 14:\n              if (useCache) {\n                _context.next = 20;\n                break;\n              }\n\n              _context.next = 17;\n              return (0, _api.fetchExtendedMapping)({\n                projectId: projectId,\n                graphqlField: graphqlField,\n                api: api\n              });\n\n            case 17:\n              _context.t1 = _context.sent;\n              _context.next = 23;\n              break;\n\n            case 20:\n              _context.next = 22;\n              return memoizedExtendedMapping({\n                projectId: projectId,\n                graphqlField: graphqlField,\n                api: api\n              });\n\n            case 22:\n              _context.t1 = _context.sent;\n\n            case 23:\n              _ref9 = _context.t1;\n              _extendedMapping = _ref9.extendedMapping;\n              s.setState({\n                loading: false,\n                extendedMapping: _extendedMapping\n              });\n\n            case 26:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function didMount(_x) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  return _react.default.createElement(_reactComponentComponent.default, {\n    initialState: initialState,\n    didMount: didMount\n  }, function (s) {\n    return children(_objectSpread({}, s.state));\n  });\n};\n\nExtendedMappingProvider.prototype = {\n  api: _propTypes.default.func,\n  useCache: _propTypes.default.bool,\n  field: _propTypes.default.string,\n  projectId: _propTypes.default.string.isRequired,\n  graphqlField: _propTypes.default.string.isRequired,\n  children: _propTypes.default.func.isRequired\n};\nvar _default = ExtendedMappingProvider;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}