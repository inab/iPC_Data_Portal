{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.Value = exports.Op = exports.Field = exports.Bubble = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _recompose = require(\"recompose\");\n\nvar _Flex = require(\"../Flex\");\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nvar Bubble = function Bubble(_ref) {\n  var _ref$className = _ref.className,\n      className = _ref$className === void 0 ? '' : _ref$className,\n      children = _ref.children,\n      props = _objectWithoutProperties(_ref, [\"className\", \"children\"]);\n\n  return _react[\"default\"].createElement(\"div\", _extends({\n    className: \"\".concat(className, \" sqon-bubble\")\n  }, props), _react[\"default\"].createElement(\"div\", null, children));\n};\n\nexports.Bubble = Bubble;\n\nvar Field = function Field(_ref2) {\n  var children = _ref2.children,\n      props = _objectWithoutProperties(_ref2, [\"children\"]);\n\n  return _react[\"default\"].createElement(Bubble, _extends({\n    className: \"sqon-field\"\n  }, props), children);\n};\n\nexports.Field = Field;\n\nvar Op = function Op(_ref3) {\n  var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, [\"children\"]);\n\n  return _react[\"default\"].createElement(Bubble, _extends({\n    className: \"sqon-op\"\n  }, props), children);\n};\n\nexports.Op = Op;\n\nvar Value = function Value(_ref4) {\n  var children = _ref4.children,\n      _ref4$className = _ref4.className,\n      className = _ref4$className === void 0 ? '' : _ref4$className,\n      props = _objectWithoutProperties(_ref4, [\"children\", \"className\"]);\n\n  return _react[\"default\"].createElement(Bubble, _extends({\n    className: \"sqon-value \".concat(className)\n  }, props), children);\n};\n\nexports.Value = Value;\nvar enhance = (0, _recompose.compose)((0, _recompose.defaultProps)({\n  FieldCrumb: function FieldCrumb(_ref5) {\n    var field = _ref5.field,\n        nextSQON = _ref5.nextSQON;\n    return _react[\"default\"].createElement(Field, {\n      onClick: function onClick() {\n        return console.log(nextSQON);\n      }\n    }, field);\n  },\n  ValueCrumb: function ValueCrumb(_ref6) {\n    var value = _ref6.value,\n        nextSQON = _ref6.nextSQON,\n        props = _objectWithoutProperties(_ref6, [\"value\", \"nextSQON\"]);\n\n    return _react[\"default\"].createElement(Value, _extends({\n      onClick: function onClick() {\n        return console.log(nextSQON);\n      }\n    }, props), value);\n  },\n  Clear: function Clear(_ref7) {\n    var nextSQON = _ref7.nextSQON;\n    return _react[\"default\"].createElement(Bubble, {\n      className: \"sqon-clear\",\n      onClick: function onClick() {\n        return console.log(nextSQON);\n      }\n    }, \"Clear\");\n  }\n}), (0, _recompose.withState)('expanded', 'setExpanded', []), (0, _recompose.withProps)(function (_ref8) {\n  var expanded = _ref8.expanded;\n  return {\n    isExpanded: function isExpanded(valueSQON) {\n      return expanded.includes(valueSQON);\n    }\n  };\n}), (0, _recompose.withHandlers)({\n  onLessClicked: function onLessClicked(_ref9) {\n    var expanded = _ref9.expanded,\n        setExpanded = _ref9.setExpanded;\n    return function (valueSQON) {\n      setExpanded((0, _lodash.xor)(expanded, [valueSQON]));\n    };\n  }\n}));\n\nvar SQON = function SQON(_ref10) {\n  var sqon = _ref10.sqon,\n      FieldCrumb = _ref10.FieldCrumb,\n      ValueCrumb = _ref10.ValueCrumb,\n      Clear = _ref10.Clear,\n      isExpanded = _ref10.isExpanded,\n      expanded = _ref10.expanded,\n      setExpanded = _ref10.setExpanded,\n      onLessClicked = _ref10.onLessClicked;\n  var sqonContent = (sqon === null || sqon === void 0 ? void 0 : sqon.content) || [];\n  var isEmpty = sqonContent.length === 0;\n  return _react[\"default\"].createElement(\"div\", {\n    className: \"sqon-view \".concat(isEmpty ? 'sqon-view-empty' : '')\n  }, isEmpty && _react[\"default\"].createElement(\"div\", {\n    className: \"sqon-empty-message\"\n  }, \"\\u2190 Start by selecting a query field\"), sqonContent.length >= 1 && _react[\"default\"].createElement(_Flex.Row, {\n    wrap: true\n  }, _react[\"default\"].createElement(_Flex.Row, {\n    className: \"sqon-group\",\n    key: \"clear\",\n    style: {\n      alignItems: 'center'\n    }\n  }, Clear({\n    nextSQON: null\n  })), sqonContent.map(function (valueSQON, i) {\n    var op = valueSQON.op,\n        _valueSQON$content = valueSQON.content,\n        field = _valueSQON$content.field,\n        fields = _valueSQON$content.fields,\n        entity = _valueSQON$content.entity;\n    var value = [].concat(valueSQON.content.value || []);\n    var isSingleValue = !Array.isArray(value) || value.length === 1;\n    return _react[\"default\"].createElement(_Flex.Row, {\n      className: \"sqon-group\",\n      key: \"\".concat(field || fields.join(), \".\").concat(op, \".\").concat(value.join()),\n      style: {\n        alignItems: 'center'\n      }\n    }, FieldCrumb({\n      field: op === 'filter' ? entity ? \"\".concat(entity, \".\").concat(op) : op : field,\n      nextSQON: (0, _utils.toggleSQON)({\n        op: 'and',\n        content: [valueSQON]\n      }, sqon)\n    }), _react[\"default\"].createElement(Op, null, op === 'in' && isSingleValue || op === 'filter' ? 'is' : op), value.length > 1 && _react[\"default\"].createElement(\"span\", {\n      className: \"sqon-value-group sqon-value-group-start\"\n    }, \"(\"), (isExpanded(valueSQON) ? value : (0, _lodash.take)(value, 2)).map(function (value, i) {\n      return ValueCrumb({\n        field: field,\n        key: value,\n        value: value,\n        className: isSingleValue ? 'sqon-value-single' : '',\n        nextSQON: op === 'filter' ? (0, _utils.replaceFilterSQON)({\n          op: 'and',\n          content: [{\n            op: op,\n            content: _objectSpread({}, entity && {\n              entity: entity\n            })\n          }]\n        }, sqon) : (0, _utils.toggleSQON)({\n          op: 'and',\n          content: [{\n            op: op,\n            content: {\n              field: field,\n              value: [value]\n            }\n          }]\n        }, sqon)\n      });\n    }), value.length > 2 && !isExpanded(valueSQON) && _react[\"default\"].createElement(\"span\", {\n      className: \"sqon-more\",\n      onClick: function onClick() {\n        return onLessClicked(valueSQON);\n      }\n    }, \"\\u2026\"), isExpanded(valueSQON) && _react[\"default\"].createElement(\"div\", {\n      className: \"sqon-less\",\n      onClick: function onClick() {\n        return onLessClicked(valueSQON);\n      }\n    }, \"Less\"), value.length > 1 && _react[\"default\"].createElement(\"span\", {\n      className: \"sqon-value-group sqon-value-group-end\"\n    }, \")\"), i < sqonContent.length - 1 && _react[\"default\"].createElement(Op, null, sqon.op));\n  })));\n};\n\nvar _default = enhance(SQON);\n\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}