{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/home/acanosa/React_arranger_template/node_modules/@babel/runtime/regenerator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _getIndexPrefix = _interopRequireDefault(require(\"./getIndexPrefix\"));\n\nvar _mapHits = _interopRequireDefault(require(\"./mapHits\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _esSearch = _interopRequireDefault(require(\"./esSearch\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nvar _default =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref) {\n    var projectId, index, es, id, lowerCaseIndex, indexPrefix, _ref3, total, fields, metaData, projectIndexData;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            projectId = _ref.projectId, index = _ref.index, es = _ref.es;\n            id = projectId.toLowerCase();\n            lowerCaseIndex = index.toLowerCase();\n            indexPrefix = (0, _getIndexPrefix[\"default\"])({\n              projectId: id,\n              index: lowerCaseIndex\n            });\n            _context.prev = 4;\n            _context.next = 7;\n            return (0, _esSearch[\"default\"])(es)({\n              index: indexPrefix,\n              size: 0,\n              _source: false\n            });\n\n          case 7:\n            _ref3 = _context.sent;\n            total = _ref3.hits.total;\n            _context.t0 = _mapHits[\"default\"];\n            _context.next = 12;\n            return (0, _esSearch[\"default\"])(es)({\n              index: indexPrefix,\n              size: total\n            });\n\n          case 12:\n            _context.t1 = _context.sent;\n            fields = (0, _context.t0)(_context.t1);\n            return _context.abrupt(\"return\", fields);\n\n          case 17:\n            _context.prev = 17;\n            _context.t2 = _context[\"catch\"](4);\n            _context.next = 21;\n            return (0, _esSearch[\"default\"])(es)({\n              index: \"arranger-projects-\".concat(projectId)\n            });\n\n          case 21:\n            metaData = _context.sent;\n            projectIndexData = (0, _lodash.get)(metaData, 'hits.hits').find(function (_ref4) {\n              var _source = _ref4._source;\n              return _source.index === index;\n            })._source;\n            return _context.abrupt(\"return\", projectIndexData.config['extended']);\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[4, 17]]);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}