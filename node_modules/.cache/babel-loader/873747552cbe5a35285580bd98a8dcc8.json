{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.addDownloadHttpHeaders = void 0;\n\nvar _uuid = _interopRequireDefault(require(\"uuid\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar httpHeaders = {};\n\nfunction getIFrameBody(iframe) {\n  var document = iframe.contentWindow || iframe.contentDocument;\n  return (document.document || document).body;\n}\n\nfunction toHtml(key, value) {\n  return \"<input\\n    type=\\\"hidden\\\"\\n    name=\\\"\".concat(key, \"\\\"\\n    aria-label=\\\"\").concat(key, \"\\\"\\n    value=\\\"\").concat(_typeof(value) === 'object' ? JSON.stringify(value).replace(/\"/g, '&quot;') : value, \"\\\"\\n  />\");\n}\n\nfunction createIFrame(_ref) {\n  var method = _ref.method,\n      url = _ref.url,\n      fields = _ref.fields;\n  var iFrame = document.createElement('iframe');\n  iFrame.style.display = 'none';\n  iFrame.src = 'about:blank';\n\n  iFrame.onload = function () {\n    this.__frame__loaded = true;\n  }; // Appending to document body to allow navigation away from the current\n  // page and downloads in the background\n\n\n  document.body.appendChild(iFrame);\n  iFrame.__frame__loaded = false;\n  var form = document.createElement('form');\n  form.method = method.toUpperCase();\n  form.action = url;\n  form.innerHTML = fields;\n  getIFrameBody(iFrame).appendChild(form);\n  form.submit();\n  return iFrame;\n}\n\nfunction download(_ref2) {\n  var url = _ref2.url,\n      params = _ref2.params,\n      _ref2$method = _ref2.method,\n      method = _ref2$method === void 0 ? 'GET' : _ref2$method,\n      _ref2$body = _ref2.body,\n      body = _ref2$body === void 0 ? {} : _ref2$body;\n  var downloadKey = (0, _uuid.default)();\n\n  var resolveOnDownload = function resolveOnDownload() {\n    return Promise.resolve();\n  };\n\n  createIFrame({\n    method: method,\n    url: url,\n    fields: Object.entries(_objectSpread({\n      params: params,\n      httpHeaders: httpHeaders\n    }, body, {\n      downloadKey: downloadKey\n    })).map(function (_ref3) {\n      var _ref4 = _slicedToArray(_ref3, 2),\n          key = _ref4[0],\n          value = _ref4[1];\n\n      return toHtml(key, value);\n    }).join('\\n')\n  });\n  return resolveOnDownload;\n}\n\nvar addDownloadHttpHeaders = function addDownloadHttpHeaders(headers) {\n  httpHeaders = _objectSpread({}, httpHeaders, {}, headers);\n};\n\nexports.addDownloadHttpHeaders = addDownloadHttpHeaders;\nvar _default = download;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}