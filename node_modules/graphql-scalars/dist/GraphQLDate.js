'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _graphql = require('graphql');

var _error = require('graphql/error');

var _language = require('graphql/language');

var _isDate = require('./isDate');

var _isDate2 = _interopRequireDefault(_isDate);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var coerceDate = function coerceDate(value) {
  var date = new Date(value);
  if (!(0, _isDate2.default)(date)) {
    var message = 'Date can\'t represent non-date value: ' + value;
    throw new TypeError(message);
  }
  return date;
};

var GraphQLDate = new _graphql.GraphQLScalarType({
  name: 'Date',
  serialize: function serialize(value) {
    return coerceDate(value).toISOString();
  },
  parseValue: coerceDate,
  parseLiteral: function parseLiteral(valueNode) {
    var kind = valueNode.kind,
        value = valueNode.value;

    var date = void 0;
    switch (kind) {
      case _language.Kind.INT:
      case _language.Kind.FLOAT:
        date = new Date(+value);
        break;
      case _language.Kind.STRING:
        date = new Date(value);
        break;
      default:
    }
    if (!(0, _isDate2.default)(date)) {
      throw new _error.GraphQLError('Expected date value but got: ' + value, [valueNode]);
    }
    return date;
  }
});

exports.default = GraphQLDate;